<!DOCTYPE html>
<html lang="en">
<head> 
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>D&D Parser – AI Resume Parser (Functional)</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

  <style>
    @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* Center the two boxed sections */
.container.features,
.container.example {
  width: min(100%, 960px);
  margin: 4rem auto;          /* centers them horizontally */
}

/* Keep the feature cards feeling balanced even when there’s spare room */
.container.features .feature-grid {
  justify-items: stretch;
}

/* Make sure the code block fills the blue panel and stays centered */
.container.example pre {
  width: 100%;
  margin: 1.5rem auto 0;
}

    .community-section {
  background: #f1f5f9;
  border-radius: 1.5rem;
  margin: 4rem auto;
  padding: 4.5rem 1.5rem;
  position: relative;
  overflow: hidden;
}

.community-section::after {
  content: "";
  position: absolute;
  inset: auto -20% -35% -20%;
  height: 50%;
  background: radial-gradient(60% 60% at 50% 0%, rgba(29,78,216,0.07), transparent 70%);
  pointer-events: none;
}

.community-subtitle {
  text-align: center;
  color: #4b5563;
  max-width: 640px;
  margin: 0.75rem auto 3rem;
  font-size: 1.05rem;
}

.community-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 2rem;
}

.community-card {
  background: white;
  padding: 2.25rem 2rem;
  border-radius: 1.25rem;
  text-align: left;
  box-shadow: 0 18px 45px rgba(15, 23, 42, 0.08);
  transition: transform 0.28s ease, box-shadow 0.28s ease;
  display: flex;
  flex-direction: column;
  gap: 1.1rem;
}

.community-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 28px 60px rgba(15, 23, 42, 0.12);
}

.community-icon {
  width: 64px;
  height: 64px;
  border-radius: 18px;
  display: grid;
  place-items: center; 
  background: #eff6ff;
}

.community-icon svg {
  width: 32px;
  height: 32px;
  fill: currentColor;
}

.community-icon.github { color: #111827; }
.community-icon.linkedin { color: #0a66c2; background: rgba(10,102,194,0.08); }
.community-icon.twitter { color: #1d9bf0; background: rgba(29,155,240,0.1); }

.community-card h3 {
  margin: 0;
  font-size: 1.35rem;
  color: #111827;
}

.community-card p {
  margin: 0;
  color: #4b5563;
}

.community-cta {
  margin-top: auto;
  font-weight: 600;
  color: #1d4ed8;
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  transition: color 0.2s ease;
}

.community-card:hover .community-cta {
  color: #10b981;
}

@media (max-width: 640px) {
  .community-section {
    padding: 3.5rem 1rem;
  }
  .community-card {
    padding: 1.75rem 1.5rem;
  }
}
    /* Reset & base */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: #f8fafc; color: #374151; line-height: 1.6; overflow-x: hidden; }
    img { max-width: 100%; display: block; }
    a { text-decoration: none; color: inherit; }

    /* Typography */
    h1, h2, h3, h4 { font-family: 'Playfair Display', serif; color: #111827; }
    h1 { font-size: 3.2rem; line-height: 1.2; }
    h2 { font-size: 2.5rem; margin-bottom: 1.5rem; text-align: center; }
    h3 { font-size: 1.5rem; margin-bottom: 0.5rem; }
    p { margin-bottom: 1rem; }

    /* Layout */
    .container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; }
    .section { padding: 5rem 0; }

    /* Navigation */
    nav {
      position: sticky; top: 0; background: rgba(255,255,255,0.95);
      -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
      z-index: 1000; padding: 1rem 0; border-bottom: 1px solid #e5e7eb;
    }
    .nav-container { display: flex; justify-content: space-between; align-items: center; }
    .logo { font-weight: 700; font-size: 1.5rem; color: #1d4ed8; }
    .nav-links { display: flex; gap: 2rem; font-weight: 500; }
    .nav-links a { position: relative; }
    .nav-links a::after {
      content: ''; position: absolute; bottom: -4px; left: 0; width: 0; height: 2px;
      background: #10b981; transition: width 0.3s ease;
    }
    .nav-links a:hover::after { width: 100%; }
    .auth-buttons { display: flex; gap: 1rem; }
    .btn { padding: 0.6rem 1.2rem; border-radius: 0.5rem; font-weight: 600; transition: all 0.3s ease; cursor: pointer; }
    .btn-outline { border: 2px solid #1d4ed8; color: #1d4ed8; }
    .btn-outline:hover { background: #1d4ed8; color: white; }
    .btn-primary { background: #1d4ed8; color: white; border: none; box-shadow: 0 4px 12px rgba(29, 78, 216, 0.3); }
    .btn-primary:hover { background: #1e40af; transform: translateY(-2px); }

    /* Hero */
    .hero { min-height: 90vh; display: flex; align-items: center; position: relative; background: linear-gradient(135deg, #dbeafe 0%, #f0fdf4 100%); }
    .hero-content { display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: center; }
    .hero-text h1 { margin-bottom: 1rem; }
    .hero-text p { font-size: 1.2rem; margin-bottom: 2rem; color: #4b5563; }
    .hero-mockup { position: relative; animation: float 6s ease-in-out infinite; transform-origin: center; }
    .ai-badge { position: absolute; top: 20%; right: -10%; background: #10b981; color: white; padding: 0.5rem 1rem; border-radius: 2rem; font-weight: 600; font-size: 0.9rem; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); animation: pulse 2s infinite; }

    /* ---------- NEW: hero layered gradient + mockup glow ---------- */
  .hero {
    position: relative;
    overflow: visible;
  }
  /* subtle animated background layer behind hero */
  .hero::before{
    content: "";
    position: absolute;
    inset: 0;
    z-index: 0;
    background: radial-gradient(1200px 400px at 10% 20%, rgba(16,185,129,0.08), transparent 12%),
                radial-gradient(900px 300px at 90% 80%, rgba(29,78,216,0.06), transparent 12%),
                linear-gradient(135deg, rgba(219,234,254,1) 0%, rgba(240,253,244,1) 100%);
    transform: translateZ(0);
    will-change: transform, opacity;
    animation: heroShift 10s ease-in-out infinite;
    pointer-events: none;
  }
  @keyframes heroShift {
    0% { transform: translateY(0) scale(1); }
    50% { transform: translateY(-6px) scale(1.01); }
    100% { transform: translateY(0) scale(1); }
  }

  /* glow filter for mockup svg */
  .resume-mockup-svg { filter: drop-shadow(0 10px 24px rgba(16,185,129,0.12)); transition: transform 220ms ease, filter 220ms ease; z-index: 2; }
  .resume-mockup-svg.glow { filter: drop-shadow(0 18px 36px rgba(16,185,129,0.18)) saturate(1.05); transform: translateY(-6px) scale(1.02); }

  /* ensure hero content sits above decorative background and particles */
  .hero .container { position: relative; z-index: 3; }

  /* respects reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .hero::before, .resume-mockup-svg { animation: none !important; transition: none !important; }
  }

    /* Curve divider */
    .curve-divider svg { width: 100%; height: 120px; display: block; }
    .curve-divider path { fill: #f8fafc; }

    /* Steps */
    .steps { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 3rem; }
    .step { background: white; padding: 2rem; border-radius: 1rem; box-shadow: 0 4px 20px rgba(0,0,0,0.05); text-align: center; transition: transform 0.3s ease; }
    .step:hover { transform: translateY(-8px); }

    /* Features */
    .features { background: #fff; margin: 3rem 0; padding: 3rem; border-radius: 1rem; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
    .feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; }
    .feature-item { display: flex; align-items: flex-start; gap: 1rem; }
    .check { color: #10b981; font-size: 1.5rem; }

    /* Example */
    .example { background: #2698aa; color: white; border-radius: 1rem; padding: 3rem; text-align: center; margin: 4rem 0; }
    .example pre { background: #173168; padding: 1.5rem; border-radius: 0.5rem; text-align: left; overflow-x: auto; font-size: 0.9rem; margin-top: 1rem; }

    /* Trust badge */
    .trust-badge { text-align: center; margin: 3rem 0; position: relative; font-weight: 600; color: #10b981; }
    .trust-badge::after { content: ''; position: absolute; bottom: -12px; left: 50%; transform: translateX(-50%); width: 120px; height: 6px; background: #10b981; border-radius: 999px; opacity: 0.8; }

    /* Final CTA */
    .final-cta { text-align: center; padding: 5rem 2rem; background: linear-gradient(135deg, #1d4ed8, #10b981); color: white; border-radius: 1.5rem; margin: 4rem 0; }
    .final-cta h2 { color: white; margin-bottom: 1rem; }
    .final-cta .btn-primary { animation: pulse 2s infinite; }

    /* Footer */
    footer { background: #111827; color: #9ca3af; padding: 3rem 0; text-align: center; }
    .footer-links { display: flex; justify-content: center; gap: 2rem; margin-bottom: 1rem; }
    .social { display: flex; justify-content: center; gap: 1rem; margin-top: 1rem; }
    .social a { font-size: 1.5rem; color: #9ca3af; transition: color 0.3s; }
    .social a:hover { color: #10b981; }

    /* Social icons (footer) */
    .social-icons {
      display: flex;
      gap: 1rem;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 0.5rem;
    }
    .social-item {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      color: #9ca3af;
      font-size: 12px;
      text-decoration: none;
      transition: transform 160ms ease, color 160ms ease, box-shadow 160ms ease;
      will-change: transform;
      outline: none;
    }
    .social-item svg { width: 28px; height: 28px; display:block; }
    .social-item:focus, .social-item:hover {
      transform: translateY(-4px) scale(1.06);
      color: #111827;
      box-shadow: 0 8px 20px rgba(16,185,129,0.12);
    }
  .social-item .label { color: #6b7280; font-size: 12px; line-height: 1; }
  /* Use theme blue by default and green on hover for all icons */
  .social-item svg { width: 28px; height: 28px; display: block; fill: #3B82F6; transition: transform 180ms ease, fill 180ms ease; }
  .social-item:hover svg, .social-item:focus svg { fill: #10B981; transform: scale(1.05); }
  /* Special layout tweaks per-item for the requested visual variations */
  /* GitHub: icon above label (default column layout covers this) */
  /* LinkedIn: label above, icon below -> swap order in markup for this one item */
  /* Twitter/X: place icon to the side (row layout) for prominence */
  .social-item.twitter { flex-direction: row; gap: 8px; }

    /* entrance animation */
    .social-icons .social-item { opacity: 0; transform: translateY(12px) scale(0.98); }
    .social-icons.show .social-item { animation: socialIn 360ms ease forwards; }
    .social-icons.show .social-item:nth-child(1){ animation-delay: 0.06s;}
    .social-icons.show .social-item:nth-child(2){ animation-delay: 0.14s;}
    .social-icons.show .social-item:nth-child(3){ animation-delay: 0.22s;}
    @keyframes socialIn {
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    /* mobile: stack vertically */
    @media (max-width: 767px) {
      .social-icons { gap: 0.5rem; }
      .social-item { flex-direction: row; gap: 0.5rem; padding: 6px 10px; border-radius: 8px; }
    }

    /* accessible focus style */
    .social-item:focus { box-shadow: 0 0 0 3px rgba(16,185,129,0.12); border-radius: 8px; }

  /* Batch comparison table styling */
  .match-high { background: #d1fae5; }
  .match-high td { border-color: #10B981 !important; }
  #comparisonTable th { cursor: pointer; }

    /* Animations */
    @keyframes float { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-20px) rotate(1deg); } }
    @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(29, 78, 216, 0.5); } 70% { box-shadow: 0 0 0 12px rgba(29, 78, 216, 0); } 100% { box-shadow: 0 0 0 0 rgba(29, 78, 216, 0); } }

    /* Upload */
    .upload-area { border: 2px dashed #1d4ed8; border-radius: 1rem; padding: 2rem; text-align: center; margin: 2rem 0; transition: all 0.3s; }
    .upload-area.dragover { background: #dbeafe; border-color: #10b981; }
    #result { margin-top: 2rem; }

  /* Selected files display */
  #fileNameDisplay { color: #10B981; font-weight: 600; margin-top: 1rem; }
  #clearFiles { background: transparent; border: 1px solid #3B82F6; color: #3B82F6; padding: 0.45rem 0.75rem; border-radius: 8px; cursor: pointer; }
  #clearFiles:hover { background: #3B82F6; color: white; }

    .hr-input-container {
      margin-bottom: 1.5rem; background: #fff; padding: 2rem; border-radius: 1rem;
      box-shadow: 0 4px 20px rgba(0,0,0,0.05);
    }

  /* particle canvas styles */
#particle-canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh; 
  pointer-events: none;   /* important — don't block clicks */
  z-index: 30;            /* adjust if it needs to be above/below UI layers */
  mix-blend-mode: normal;
}

@media (prefers-reduced-motion: reduce) {
  .resume-appear, .resume-mockup-svg, .btn { animation: none !important; transition: none !important; }
}

/* Stage/entrance */
.resume-appear { opacity: 0; transform: translateY(12px); transition: opacity 480ms ease, transform 480ms cubic-bezier(.2,.9,.3,1); }
.resume-appear.visible { opacity: 1; transform: translateY(0); }

/* Mockup float */
.resume-mockup-svg { will-change: transform; transform-origin: 50% 50%; animation: bob 4s ease-in-out infinite; width: 360px; height: auto; display:block; margin: 0 auto; }
@keyframes bob { 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-8px) } }

/* Button hover + pulse */
.btn-primary { transition: transform 180ms ease, box-shadow 220ms ease; will-change: transform; }
.btn-primary:hover { transform: translateY(-3px) scale(1.03); box-shadow: 0 12px 30px rgba(29,78,216,0.18); }

/* Ripple (JS will insert .ripple span) */
.btn { position: relative; overflow: hidden; }
.btn .ripple { position: absolute; border-radius: 50%; transform: scale(0); opacity: 0.6; pointer-events:none; background: rgba(255,255,255,0.25); animation: ripple 600ms ease-out; }
@keyframes ripple { to { transform: scale(6); opacity: 0; } }

/* Small utility for hero children stagger */
.hero .stagger > * { opacity: 0; transform: translateY(12px); transition: opacity 420ms ease, transform 420ms cubic-bezier(.2,.9,.3,1); }
.hero .stagger.show > * { opacity: 1; transform: translateY(0); }
.hero .stagger.show > *:nth-child(1) { transition-delay: 120ms; }
.hero .stagger.show > *:nth-child(2) { transition-delay: 240ms; }
.hero .stagger.show > *:nth-child(3) { transition-delay: 360ms; }

  /* --- See It In Action split view for single result --- */
  .results-split { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-items: start; }
  .json-panel { background: linear-gradient(180deg,#eff6ff,#dbeafe); border:1px solid #3B82F6; border-radius:8px; padding:12px; overflow:auto; }
  .json-panel h4 { margin:0 0 8px 0; color:#1e3a8a; }
  .json-code { background:#0f1724; color:#e6eef8; padding:12px; border-radius:6px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', 'Courier New', monospace; font-size:0.9rem; white-space:pre; overflow:auto; }
  .table-panel { background:#ffffff; border:1px solid #e6f4ea; border-radius:8px; padding:12px; }
  .table-panel h4 { margin:0 0 8px 0; color:#065f46; }
  #single-table { width:100%; border-collapse:collapse; display:none; }
  #single-table th, #single-table td { padding:0.6rem; border:1px solid #e6eefc; text-align:left; }
  @media (max-width: 768px) { .results-split { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <!-- Particle canvas (non-interactive) -->
  <canvas id="particle-canvas" aria-hidden="true"></canvas>

  <!-- rest of your page... -->


  <nav>
    <div class="container nav-container">
      <div class="logo">D&D Parser</div>
      <div class="nav-links">
        <a href="#">Builder</a>
        <a href="#">Resume</a>
        <a href="#">CV</a>
        <a href="#">Cover Letter</a>
        <a href="#">Advice</a>
        <a href="#">Resources</a>
      </div>
      <div class="auth-buttons">
        <button class="btn btn-outline">Login</button>
        <button class="btn btn-primary">Free Account</button>
      </div>
      <div class="mobile-menu">Menu</div>
    </div>
  </nav>

  <section class="hero section">
    <div class="container hero-content">
      <div class="hero-text" data-aos="fade-right">
        <h1>Free Resume Parser</h1>
        <h2 style="font-size: 2rem; color: #1d4ed8; margin: 1rem 0;">Analysis in Seconds</h2>
        <p>Get instant insights: extract name, skills, experience, education — all in one click.</p>
        <button class="btn btn-primary" onclick="scrollToUpload()">Parse My Resume – Free</button>
      </div>
      <div class="hero-mockup" data-aos="fade-left" data-aos-delay="200">
        <!-- Inline SVG fallback mockup (no external fetch) -->
        <svg class="resume-mockup-svg" width="360" height="500" viewBox="0 0 360 500" aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="g1" x1="0" x2="1" y1="0" y2="1">
              <stop offset="0%" stop-color="#e6f6ff"/>
              <stop offset="100%" stop-color="#f0fff6"/>
            </linearGradient>
          </defs>
          <rect x="16" y="24" rx="18" ry="18" width="328" height="452" fill="url(#g1)" stroke="#cfeef4" stroke-width="2"/>
          <!-- mini PDF corner -->
          <path d="M264 24 H304 V64" fill="#ffd54a" stroke="#f59e0b" />
          <!-- page lines -->
          <g fill="#2b6cb0" opacity="0.95">
            <rect x="48" y="88" width="264" height="14" rx="6"/>
            <rect x="48" y="114" width="200" height="10" rx="5" opacity="0.85"/>
            <rect x="48" y="138" width="264" height="10" rx="5" opacity="0.6"/>
            <rect x="48" y="170" width="264" height="10" rx="5" opacity="0.6"/>
          </g>
          <!-- skill pills -->
          <g transform="translate(48,210)">
            <rect x="0" y="0" width="84" height="22" rx="11" fill="#10b981" opacity="0.95"/>
            <rect x="96" y="0" width="64" height="22" rx="11" fill="#1d4ed8" opacity="0.95"/>
            <rect x="176" y="0" width="80" height="22" rx="11" fill="#f59e0b" opacity="0.95"/>
          </g>
          <!-- green circular AI badge -->
          <circle cx="300" cy="380" r="36" fill="#10b981" stroke="#0ea36c" stroke-width="4"/>
          <text x="300" y="388" font-family="Inter, sans-serif" font-weight="700" font-size="20" text-anchor="middle" fill="#fff"></text>
        </svg>
        <div class="ai-badge"></div>
      </div>
    </div>
  </section>

  <div class="curve-divider">
    <svg viewBox="0 0 1440 120" preserveAspectRatio="none" aria-hidden="true">
      <path d="M0,0 C320,100 1120,20 1440,0 L1440,120 L0,120 Z"></path>
    </svg>
  </div>

  <section class="section">
    <div class="container">
      <h2>How <span style="color:#1d4ed8;">D&D Parser</span> Works</h2>
      <div class="steps">
        <div class="step" data-aos="fade-up">
          <!-- Step 1: Upload (inline SVG) -->
          <svg width="80" height="80" viewBox="0 0 80 80" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 1rem; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));" role="img" aria-labelledby="ico-upload">
            <title id="ico-upload">Upload Icon</title>
            <rect x="20" y="20" width="40" height="40" rx="6" fill="#f8fafc" stroke="#1d4ed8" stroke-width="2"/>
            <path d="M40 28 L40 50 M32 36 L40 28 L48 36" fill="none" stroke="#1d4ed8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <rect x="24" y="50" width="32" height="6" rx="3" fill="#10b981" opacity="0.2"/>
          </svg>
          <h3>1. Upload Resume</h3>
          <p>PDF, DOCX, TXT — any format works.</p>
        </div>

        <div class="step" data-aos="fade-up" data-aos-delay="200">
          <!-- Step 2: AI (inline SVG) -->
          <svg width="80" height="80" viewBox="0 0 80 80" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 1rem; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));" role="img" aria-labelledby="ico-ai">
            <title id="ico-ai">AI Processing Icon</title>
            <circle cx="40" cy="40" r="28" fill="none" stroke="#6b7280" stroke-width="2"/>
            <circle cx="28" cy="32" r="4" fill="#1d4ed8"/>
            <circle cx="52" cy="32" r="4" fill="#1d4ed8"/>
            <circle cx="40" cy="52" r="4" fill="#10b981"/>
            <line x1="28" y1="32" x2="52" y2="32" stroke="#1d4ed8" stroke-width="2"/>
            <line x1="52" y1="32" x2="40" y2="52" stroke="#10b981" stroke-width="2"/>
            <line x1="28" y1="32" x2="40" y2="52" stroke="#10b981" stroke-width="2"/>
          </svg>
          <h3>2. AI Extracts</h3>
          <p>Skills, jobs, education — 98% accurate.</p>
        </div>

        <div class="step" data-aos="fade-up" data-aos-delay="400">
          <!-- Step 3: JSON (inline SVG) -->
          <svg width="80" height="80" viewBox="0 0 80 80" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 1rem; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));" role="img" aria-labelledby="ico-json">
            <title id="ico-json">JSON Document Icon</title>
            <rect x="24" y="20" width="32" height="40" rx="4" fill="#dbeafe" stroke="#1d4ed8" stroke-width="2"/>
            <rect x="28" y="26" width="24" height="4" rx="2" fill="#1d4ed8" opacity="0.6"/>
            <rect x="28" y="34" width="20" height="3" rx="1.5" fill="#6b7280" opacity="0.8"/>
            <rect x="28" y="41" width="16" height="3" rx="1.5" fill="#6b7280" opacity="0.8"/>
            <rect x="28" y="48" width="10" height="3" rx="1.5" fill="#6b7280" opacity="0.8"/>
          </svg>
          <h3>3. View Output</h3>
          <p>Clean JSON, summary, skill cloud.</p>
        </div>

        <div class="step" data-aos="fade-up" data-aos-delay="600">
          <!-- Step 4: Download (inline SVG) -->
          <svg width="80" height="80" viewBox="0 0 80 80" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 1rem; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));" role="img" aria-labelledby="ico-download">
            <title id="ico-download">Download Icon</title>
            <path d="M40 22 L40 46" stroke="#1d4ed8" stroke-width="2" stroke-linecap="round"/>
            <path d="M32 38 L40 46 L48 38" fill="none" stroke="#1d4ed8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <rect x="24" y="50" width="32" height="8" rx="4" fill="#10b981" opacity="0.2"/>
          </svg>
          <h3>4. Download</h3>
          <p>Export as JSON, CSV, or enhanced resume.</p>
        </div>
      </div>
    </div>
  </section>

  <section class="section" id="upload-section">
    <div class="container">
      <form id="uploadForm">
        <div class="hr-input-container">
          <label for="hr_skills_input" style="font-weight: 700; font-size: 1.2rem; color: #111827; display: block; margin-bottom: 0.75rem;">
            <strong>Step 1:</strong> Enter Required HR Skills (Comma-separated)
          </label>
          <input type="text" id="hr_skills_input" name="hr_skills"
                 placeholder="e.g., Python, Flask, API Development"
                 required
                 style="width: 100%; padding: 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; font-family: 'Inter', sans-serif; font-size: 1rem;">
        </div>

        <div class="upload-area" id="uploadArea">
          <p style="font-size: 1.2rem; margin-bottom: 1rem; color: #111827; font-weight: 700;">
            <strong>Step 2:</strong> Upload Resume
          </p>
          <p><strong>Drag &amp; drop your resume here</strong> or click to upload</p>

          <!-- Upload controls: sun icon above the choose button -->
          <div class="upload-control" style="display:flex; flex-direction:column; align-items:center; gap:0.75rem;">
            <!-- Sun-style SVG (replaces previous upload icon) -->
            <svg id="sun-upload-icon" width="72" height="72" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg" style="display:block;" role="img" aria-labelledby="ico-sun-upload">
              <title id="ico-sun-upload">Sun Upload Icon</title>
              <!-- core circle -->
              <circle cx="36" cy="36" r="14" fill="#ffd54a" stroke="#f59e0b" stroke-width="2"/>
              <!-- rays -->
              <g stroke="#f59e0b" stroke-width="2" stroke-linecap="round">
                <line x1="36" y1="6" x2="36" y2="14"/>
                <line x1="36" y1="58" x2="36" y2="66"/>
                <line x1="6" y1="36" x2="14" y2="36"/>
                <line x1="58" y1="36" x2="66" y2="36"/>
                <line x1="14" y1="14" x2="20" y2="20"/>
                <line x1="52" y1="52" x2="58" y2="58"/>
                <line x1="14" y1="58" x2="20" y2="52"/>
                <line x1="52" y1="20" x2="58" y2="14"/>
              </g>
              <!-- small document symbol inside sun to hint upload -->
              <rect x="30" y="30" width="12" height="12" rx="1.5" fill="#fff" opacity="0.95"/>
              <path d="M33 34 L39 34" stroke="#f59e0b" stroke-width="1.2" stroke-linecap="round"/>
            </svg>

            <input type="file" id="resumeInput" name="resume_file" accept=".pdf,.docx,.txt" style="display:none;" required>

            <button type="button" class="btn btn-primary" onclick="document.getElementById('resumeInput').click()" style="margin-top:0.25rem;">
              Choose Resume File
            </button>
            <label style="margin-top:0.5rem; font-size:0.95rem; color:#374151; display:flex; flex-direction:column; gap:0.5rem; align-items:flex-start;">
              <div style="display:flex; gap:0.5rem; align-items:center;">
                <input type="checkbox" id="batchToggle" aria-label="Enable batch mode (up to 5 resumes)"> <strong> Batch mode (compare up to 5)</strong>
              </div>
              <!-- NOTE: Removed the secondary HR skills textarea (Step 2). Use the Step 1 input above for required skills. -->
            </label>
          </div>
          <p id="fileNameDisplay" style="margin-top: 1rem; color: #10B981; font-weight: 600;"> </p>
          <button type="button" id="clearFiles" class="btn btn-outline" style="display:none; margin-top:0.5rem;">Clear Files</button>
        </div>

        <button type="submit" class="btn btn-primary" style="width: 100%; padding: 1rem; font-size: 1.2rem; margin-top: 1rem; background: #10b981; border: none; animation: pulse 2s infinite;">
          Analyze &amp; Match
        </button>
      </form>

      <div id="result"></div>
      <!-- Comparison view for batch results -->
      <div id="comparisonView" style="display:none; margin-top:1.5rem;">
        <div style="background:white; padding:1rem; border-radius:0.75rem; box-shadow:0 8px 24px rgba(0,0,0,0.06);">
          <h3 style="color:#1d4ed8; margin-bottom:0.5rem;">Batch Comparison Results</h3>
          <div id="comparisonSummary" style="margin-bottom:1rem; color:#374151;"></div>
          <div style="display:flex; justify-content:space-between; align-items:center; gap:8px; margin-bottom:0.5rem;">
            <div style="font-size:0.95rem; color:#374151;">Compare resumes against provided required skills. Use Export to save CSV.</div>
            <div style="display:flex; gap:8px;">
              <button id="exportCsvBtn" class="btn btn-outline" style="font-size:0.9rem;">Export CSV</button>
            </div>
          </div>
          <div style="overflow-x:auto;">
            <table id="comparisonTable" style="width:100%; border-collapse:collapse;">
              <thead>
                <tr style="background:#eff6ff;">
                  <th data-col="candidate" style="padding:0.6rem; border:1px solid #e6eefc; text-align:left; cursor:pointer;">Candidate</th>
                  <th data-col="required" style="padding:0.6rem; border:1px solid #e6eefc; text-align:left; cursor:pointer;">Required Skills</th>
                  <th data-col="matched" style="padding:0.6rem; border:1px solid #e6eefc; text-align:left; cursor:pointer;">Matched Skills</th>
                  <th data-col="pct" style="padding:0.6rem; border:1px solid #e6eefc; text-align:left; cursor:pointer;">Match %</th>
                  <th data-col="selected" style="padding:0.6rem; border:1px solid #e6eefc; text-align:left;">Selected</th>
                </tr>
              </thead>
              <tbody id="comparisonBody"></tbody>
            </table>
          </div>
        </div>
      </div>

      <div id="loadingSpinner" style="display: none; text-align: center; margin-top: 2rem;">
        <!-- Inline spinner -->
        <svg width="50" height="50" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 1rem; animation: rotate 2s linear infinite;" role="img" aria-labelledby="ico-processing">
          <title id="ico-processing">Processing Spinner</title>
          <circle cx="25" cy="25" r="20" fill="none" stroke="#6b7280" stroke-width="3" stroke-dasharray="10 10"/>
          <circle cx="15" cy="15" r="3" fill="#1d4ed8"/>
          <circle cx="35" cy="15" r="3" fill="#1d4ed8"/>
          <circle cx="25" cy="35" r="3" fill="#10b981"/>
        </svg>
        <p style="font-size: 1.2rem; color: #1d4ed8;">Analyzing... Please wait.</p>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container features">
      <h2>Why Job Seekers Love D&D Parser</h2>
      <div class="feature-grid">
        <div class="feature-item"><span class="check">✓</span> <div>Supports PDF, DOCX, TXT</div></div>
        <div class="feature-item"><span class="check">✓</span> <div>Extracts skills and Key Data for Comparison</div></div>
        <div class="feature-item"><span class="check">✓</span> <div>Smart skill matching (tech + soft)</div></div>
        <div class="feature-item"><span class="check">✓</span> <div>JSON &amp; CSV export</div></div>
        <div class="feature-item"><span class="check">✓</span> <div>Privacy first – files deleted in 24h</div></div>
        <div class="feature-item"><span class="check">✓</span> <div>Free first parse – no card needed</div></div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container example">
      <h3>See It in Action</h3>
      <pre id="jsonExample">
  {
  "detailed_skills": [
    {
      "matched": true,
      "skill": "html"
    },
    {
      "matched": false,
      "skill": "python"
    },
    {
      "matched": false,
      "skill": "react"
    },
    {
      "matched": true,
      "skill": "solving"
    },
    {
      "matched": true,
      "skill": "css"
    },
    {
      "matched": true,
      "skill": "problem"
    }
  ],
  "matched_skills_count": 4,
  "message": "Data cleaned and initial matching completed.",
  "percentage_match": 66.66666666666666,
  "total_hr_skills": 6
}</pre>
    </div>
  </section>

  <div class="trust-badge">
    AI Trained on Real Resumes • Backend by NLP
  </div>

  <section class="final-cta">
    <h2>Stop Guessing. Start Parsing.</h2>
    <p>Join job seekers to trust and support D&D Parser.</p>
    <button class="btn btn-primary" onclick="scrollToUpload()">Parse My Resume – Free</button>
  </section>

  <footer>
    <div class="container">
      <div class="footer-links">
        <a href="#">Privacy</a> | <a href="#">Terms</a> | <a href="#">Contact</a>
      </div>
<section class="section community-section">
  <div class="container">
    <h2 data-aos="fade-up">Connect with <span style="color:#1d4ed8;">D&amp;D Parser</span></h2>
    <p class="community-subtitle" data-aos="fade-up" data-aos-delay="120">
      Follow our journey, contribute, and stay in sync with new releases.
    </p>

    <div class="community-grid">
      <!-- GitHub -->
      <a class="community-card" href="https://github.com/youruser" target="_blank" rel="noopener noreferrer"
         data-aos="zoom-in" data-aos-delay="180" aria-label="Visit our GitHub repository">
        <div class="community-icon github">
          <svg viewBox="0 0 24 24" aria-hidden="true" role="img">
            <path d="M12 .5C5.65.5.5 5.65.5 12c0 5.08 3.29 9.39 7.86 10.91.58.11.79-.25.79-.56 0-.28-.01-1.02-.02-2-3.2.7-3.88-1.54-3.88-1.54-.53-1.35-1.28-1.71-1.28-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.77 1.2 1.77 1.2 1.03 1.77 2.7 1.26 3.36.96.1-.75.4-1.26.72-1.55-2.56-.29-5.26-1.28-5.26-5.69 0-1.26.45-2.29 1.18-3.1-.12-.29-.51-1.47.11-3.06 0 0 .96-.31 3.15 1.18a10.9 10.9 0 0 1 2.87-.39c.97.01 1.95.13 2.87.39 2.18-1.49 3.14-1.18 3.14-1.18.62 1.59.23 2.77.12 3.06.74.81 1.18 1.84 1.18 3.1 0 4.42-2.71 5.4-5.29 5.68.41.36.78 1.08.78 2.18 0 1.58-.01 2.85-.01 3.24 0 .31.21.68.8.56C20.71 21.38 24 17.08 24 12 24 5.65 18.35.5 12 .5z"/>
          </svg>
        </div>
        <h3>GitHub</h3>
        <p>Explore the code, open issues, and contribute to upcoming modules.</p>
        <span class="community-cta">Go to GitHub →</span>
      </a>

      <!-- LinkedIn -->
      <a class="community-card" href="https://www.linkedin.com/in/yourprofile" target="_blank" rel="noopener noreferrer"
         data-aos="zoom-in" data-aos-delay="220" aria-label="Visit our LinkedIn page">
        <div class="community-icon linkedin">
          <svg viewBox="0 0 24 24" aria-hidden="true" role="img">
            <path d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM0 8.99h5V24H0V8.99zM8.5 8.99h4.74v2.04h.07c.66-1.25 2.28-2.57 4.7-2.57 5.03 0 5.96 3.31 5.96 7.61V24h-5v-7.93c0-1.89-.03-4.33-2.64-4.33-2.64 0-3.04 2.06-3.04 4.19V24h-5V8.99z"/>
          </svg>
        </div>
        <h3>LinkedIn</h3>
        <p>Stay updated with product launches, hiring news, and career tips.</p>
        <span class="community-cta">Connect on LinkedIn →</span>
      </a>

      <!-- Twitter/X -->
      <a class="community-card" href="https://twitter.com/yourhandle" target="_blank" rel="noopener noreferrer"
         data-aos="zoom-in" data-aos-delay="260" aria-label="Visit our Twitter/X profile">
        <div class="community-icon twitter">
          <svg viewBox="0 0 24 24" aria-hidden="true" role="img">
            <path d="M23 4.56c-.8.36-1.66.6-2.56.71a4.48 4.48 0 0 0 1.97-2.48 9.03 9.03 0 0 1-2.85 1.09 4.5 4.5 0 0 0-7.68 4.1A12.8 12.8 0 0 1 2.64 3.16a4.5 4.5 0 0 0 1.4 6.01 4.48 4.48 0 0 1-2.04-.56v.06a4.5 4.5 0 0 0 3.61 4.41 4.47 4.47 0 0 1-2.03.08 4.5 4.5 0 0 0 4.2 3.12A9.03 9.03 0 0 1 1 19.54a12.75 12.75 0 0 0 6.91 2.03c8.3 0 12.84-6.88 12.84-12.84 0-.2 0 .41-.01.61A9.2 9.2 0 0 0 23 4.56z"/>
          </svg>
        </div>
        <h3>Twitter / X</h3>
        <p>Get quick updates, feature teasers, and community shout‑outs.</p>
        <span class="community-cta">Follow on X →</span>
      </a>
    </div>
  </div>
</section>
      <!-- Social icons row (added) -->
      <div class="social-icons" id="socialIcons" aria-label="Follow D&D Parser on social media">
        <!-- GitHub: icon above label -->
        <a class="social-item github" href="https://github.com/youruser" target="_blank" rel="noopener noreferrer" aria-label="GitHub — D and D Parser">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" role="img" xmlns="http://www.w3.org/2000/svg">
            <title>GitHub</title>
            <path d="M12 .5C5.65.5.5 5.65.5 12c0 5.08 3.29 9.39 7.86 10.91.58.11.79-.25.79-.56 0-.28-.01-1.02-.02-2-3.2.7-3.88-1.54-3.88-1.54-.53-1.35-1.28-1.71-1.28-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.77 1.2 1.77 1.2 1.03 1.77 2.7 1.26 3.36.96.1-.75.4-1.26.72-1.55-2.56-.29-5.26-1.28-5.26-5.69 0-1.26.45-2.29 1.18-3.1-.12-.29-.51-1.47.11-3.06 0 0 .96-.31 3.15 1.18a10.9 10.9 0 0 1 2.87-.39c.97.01 1.95.13 2.87.39 2.18-1.49 3.14-1.18 3.14-1.18.62 1.59.23 2.77.12 3.06.74.81 1.18 1.84 1.18 3.1 0 4.42-2.71 5.4-5.29 5.68.41.36.78 1.08.78 2.18 0 1.58-.01 2.85-.01 3.24 0 .31.21.68.8.56C20.71 21.38 24 17.08 24 12 24 5.65 18.35.5 12 .5z"/>
          </svg>
          <span class="label">GitHub</span>
        </a>

        <!-- LinkedIn: label above, icon below (markup order swapped intentionally) -->
        <a class="social-item linkedin" href="https://www.linkedin.com/in/yourprofile" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn — D and D Parser">
          <span class="label">LinkedIn</span>
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" role="img" xmlns="http://www.w3.org/2000/svg">
            <title>LinkedIn</title>
            <path d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM0 8.99h5V24H0V8.99zM8.5 8.99h4.74v2.04h.07c.66-1.25 2.28-2.57 4.7-2.57 5.03 0 5.96 3.31 5.96 7.61V24h-5v-7.93c0-1.89-.03-4.33-2.64-4.33-2.64 0-3.04 2.06-3.04 4.19V24h-5V8.99z"/>
          </svg>
        </a>

        <!-- Twitter / X: icon to the side of label for a compact variation -->
        <a class="social-item twitter" href="https://twitter.com/yourhandle" target="_blank" rel="noopener noreferrer" aria-label="Visit our Twitter/X profile">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" role="img" xmlns="http://www.w3.org/2000/svg">
            <title>Twitter</title>
            <path d="M23 4.56c-.8.36-1.66.6-2.56.71a4.48 4.48 0 0 0 1.97-2.48 9.03 9.03 0 0 1-2.85 1.09 4.5 4.5 0 0 0-7.68 4.1A12.8 12.8 0 0 1 2.64 3.16a4.5 4.5 0 0 0 1.4 6.01 4.48 4.48 0 0 1-2.04-.56v.06a4.5 4.5 0 0 0 3.61 4.41 4.47 4.47 0 0 1-2.03.08 4.5 4.5 0 0 0 4.2 3.12A9.03 9.03 0 0 1 1 19.54a12.75 12.75 0 0 0 6.91 2.03c8.3 0 12.84-6.88 12.84-12.84 0-.2 0 .41-.01.61A9.2 9.2 0 0 0 23 4.56z"/>
          </svg>
          <span class="label">Twitter / X</span>
        </a>
      </div>

      <p>&copy; 2025 D&D Parser. All rights reserved.</p>
    </div>
  </footer>

  <!-- JS at end for performance -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init({ duration: 800, easing: 'cubic-bezier(0.25, 0.8, 0.25, 1)', once: true });

    function scrollToUpload() {
      document.getElementById('upload-section').scrollIntoView({ behavior: 'smooth' });
    }

    const uploadForm = document.getElementById('uploadForm');
    const resumeInput = document.getElementById('resumeInput');
    const uploadArea = document.getElementById('uploadArea');
    const resultDiv = document.getElementById('result');
    const fileNameDisplay = document.getElementById('fileNameDisplay');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const hrSkillsInput = document.getElementById('hr_skills_input');

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(evt => {
      uploadArea.addEventListener(evt, preventDefaults, false);
    });
    function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }
    ['dragenter', 'dragover'].forEach(evt => {
      uploadArea.addEventListener(evt, () => uploadArea.classList.add('dragover'), false);
    });
    ['dragleave', 'drop'].forEach(evt => {
      uploadArea.addEventListener(evt, () => uploadArea.classList.remove('dragover'), false);
    });

    uploadArea.addEventListener('drop', handleDrop, false);
    resumeInput.addEventListener('change', handleFiles, false);

    const batchToggleEl = document.getElementById('batchToggle');
    const clearBtn = document.getElementById('clearFiles');

    // Ensure the input allows multiple selection only when batch mode is enabled
    if (batchToggleEl) {
      batchToggleEl.addEventListener('change', (ev) => {
        const checked = !!ev.target.checked;
        resumeInput.multiple = checked;
        // When switching out of batch mode, clear any multi-selection to avoid accidental multi-submits
        if (!checked) {
          resumeInput.value = '';
          fileNameDisplay.textContent = '';
          window._selectedFiles = [];
          if (clearBtn) clearBtn.style.display = 'none';
        }
      }, false);
    }

    if (clearBtn) {
      clearBtn.addEventListener('click', () => {
        resumeInput.value = '';
        fileNameDisplay.textContent = '';
        window._selectedFiles = [];
        clearBtn.style.display = 'none';
      }, false);
    }

    function handleDrop(e) {
      const dt = e.dataTransfer;
      if (!dt || !dt.files || dt.files.length === 0) return;
      resumeInput.files = dt.files;
      handleFiles({ target: resumeInput });
    }
    function renderSelectedFiles() {
      const sel = window._selectedFiles || [];
      const isBatch = batchToggleEl && batchToggleEl.checked;
      if (!sel.length) {
        fileNameDisplay.textContent = '';
        if (clearBtn) clearBtn.style.display = 'none';
        return;
      }

      if (isBatch) {
        // show names and provide a remove button per file
        function esc(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
        const namesHtml = sel.map(f => `<span style="display:inline-block;margin-right:8px;padding:3px 6px;border-radius:6px;background:#f1f5f9;">${esc(f.name)} <button type="button" class="remove-single" data-name="${esc(f.name)}" style="background:transparent;border:none;color:#3B82F6;cursor:pointer;padding:0;margin-left:6px;font-weight:700;">✕</button></span>`).join(' ');
        fileNameDisplay.innerHTML = `Files Selected (${sel.length}/5): ${namesHtml}`;
        if (clearBtn) clearBtn.style.display = 'inline-block';
        // attach remove handlers
        document.querySelectorAll('.remove-single').forEach(btn => {
          btn.addEventListener('click', (ev) => {
            ev.preventDefault();
            const name = btn.getAttribute('data-name');
            removeSelectedFile(name);
          }, false);
        });
      } else {
        fileNameDisplay.textContent = `File Selected: ${sel[0].name}`;
        if (clearBtn) clearBtn.style.display = 'inline-block';
      }
    }

    // Remove a file from the stored selection by name
    function removeSelectedFile(name) {
      const sel = window._selectedFiles || [];
      window._selectedFiles = sel.filter(f => f.name !== name);
      renderSelectedFiles();
    }

    function handleFiles(e) {
      const incoming = e.target.files ? Array.from(e.target.files) : [];
      const isBatch = batchToggleEl && batchToggleEl.checked;
      if (!incoming.length) {
        return;
      }

      if (isBatch) {
        // append deduped to stored selection
        let existing = window._selectedFiles && Array.isArray(window._selectedFiles) ? window._selectedFiles.slice() : [];
        incoming.forEach(f => {
          if (!existing.some(s => s.name === f.name)) existing.push(f);
        });
        if (existing.length > 5) {
          alert('Max 5 files allowed for batch analysis — extra files will be ignored.');
          existing = existing.slice(0, 5);
        }
        window._selectedFiles = existing;
        renderSelectedFiles();
      } else {
        // single mode: replace with the first selected file
        window._selectedFiles = [incoming[0]];
        renderSelectedFiles();
      }
    }

    uploadForm.addEventListener('submit', async (event) => {
      event.preventDefault();

      // Use only the Step 1 HR skills input (`#hr_skills_input`) as the canonical source.
      if (!hrSkillsInput.value.trim()) { alert('Please enter the required HR Skills.'); return; }

      // Files may be stored in resumeInput.files (single selection) or window._selectedFiles (batch cumulative selection)
      const selectedFilesCount = (window._selectedFiles && window._selectedFiles.length) ? window._selectedFiles.length : (resumeInput.files && resumeInput.files.length ? resumeInput.files.length : 0);
      if (selectedFilesCount === 0) { alert('Please select a resume file first.'); return; }

      const isBatch = document.getElementById('batchToggle')?.checked;

      resultDiv.innerHTML = '';
      document.getElementById('comparisonView').style.display = 'none';
      loadingSpinner.style.display = 'block';
      document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'start' });

      try {
        if (isBatch) {
          // Batch path: build custom FormData and POST to /batch-analyze
          let files = (window._selectedFiles && window._selectedFiles.length) ? window._selectedFiles.slice() : Array.from(resumeInput.files || []);
          if (!files || files.length === 0) { alert('Please select at least one resume for batch analysis.'); return; }
          if (files.length > 5) { alert('Max 5 files allowed for batch analysis — extra files will be ignored.'); files = files.slice(0,5); }

          const fd = new FormData();
          // include hr_skills from Step 1 (canonical input)
          fd.append('hr_skills', hrSkillsInput.value.trim());
          files.forEach((f) => fd.append('files[]', f, f.name));

          const response = await fetch('http://127.0.0.1:5000/batch-analyze', { method: 'POST', body: fd });
          if (!response.ok) {
            const err = await response.json().catch(() => ({ message: 'Server error' }));
            throw new Error(err.message || 'Batch request failed');
          }
          const data = await response.json();
          displayBatchResult(data);
        } else {
          // Single-file path: preserve existing behavior
          const formData = new FormData(uploadForm);
          // ensure the HR skills value from Step 1 is included
          formData.set('hr_skills', hrSkillsInput.value.trim());
          const response = await fetch('http://127.0.0.1:5000/upload', {
            method: 'POST',
            body: formData
          });

          if (!response.ok) {
            const errorData = await response.json().catch(() => ({ message: 'Server error or invalid response format.' }));
            throw new Error('API Request Failed: ' + response.status + ' - ' + (errorData.message || 'Unknown Error'));
          }

          const data = await response.json();
          displayResult(data);
        }
      } catch (error) {
        console.error('Submission Error:', error);
        resultDiv.innerHTML = `
          <div style="background:#fee2e2; color:#b91c1c; padding:1.5rem; border-radius:1rem; margin-top:2rem;">
            <h3>❌ Analysis Failed</h3>
            <p>An error occurred: <strong>${error.message || 'Could not connect to the parsing server.'}</strong></p>
            <p>Please ensure your <strong>Flask server is running</strong> at <code>http://127.0.0.1:5000/</code>.</p>
          </div>
        `;
      } finally {
        loadingSpinner.style.display = 'none';
      }
    });

    function displayBatchResult(data) {
      // data.parsed = [{candidate, text_snippet, top_tokens}], data.comparisons.similarity_matrix
      const tableBody = document.getElementById('comparisonBody');
      const summary = document.getElementById('comparisonSummary');
      tableBody.innerHTML = '';
      summary.textContent = `Common tokens across resumes: ${ (data.comparisons && data.comparisons.common_skills && data.comparisons.common_skills.length) ? data.comparisons.common_skills.join(', ') : 'None' }`;

      // keep a copy of last batch for sorting/export
      window._lastBatch = data;

      function renderRows(rows) {
        tableBody.innerHTML = '';
        rows.forEach(p => {
          const pct = (p.match_pct !== undefined) ? Number(p.match_pct) : 0;
          const pctBar = `<svg width="120" height="12" style="background:#eef2ff; border-radius:6px; overflow:visible;"><rect x="0" y="1" width="120" height="10" rx="6" fill="#eef2ff"></rect><rect x="0" y="1" width="${Math.round(Math.max(0,Math.min(1,pct/100))*120)}" height="10" rx="6" fill="${pct>=80? '#10B981': (pct>=50? '#3B82F6':'#9CA3AF')}"></rect></svg>`;
          const tr = document.createElement('tr');
          if (pct >= 80) tr.className = 'match-high';
          tr.innerHTML = `
            <td style="padding:0.6rem; border:1px solid #e6eefc; vertical-align:top;">${p.candidate}</td>
            <td style="padding:0.6rem; border:1px solid #e6eefc; vertical-align:top;">${(p.required_skills || []).join(', ')}</td>
            <td style="padding:0.6rem; border:1px solid #e6eefc; vertical-align:top;">${(p.matched_skills || []).join(', ')}</td>
            <td style="padding:0.6rem; border:1px solid #e6eefc; vertical-align:top;">${pctBar} <span style="margin-left:8px; font-weight:600;">${pct.toFixed(1)}%</span></td>
            <td style="padding:0.6rem; border:1px solid #e6eefc; vertical-align:top; text-align:center;"> <input type="checkbox" data-candidate="${p.candidate}" ${p.selected ? 'checked' : ''}/> </td>
          `;
          tableBody.appendChild(tr);
        });
      }

      renderRows(data.parsed || []);

      // sortable headers
      document.querySelectorAll('#comparisonTable thead th[data-col]').forEach(th => {
        th.style.userSelect = 'none';
        th.onclick = () => {
          const col = th.getAttribute('data-col');
          const rows = (window._lastBatch && window._lastBatch.parsed) ? window._lastBatch.parsed.slice() : [];
          rows.sort((a,b) => {
            if (col === 'pct') return (b.match_pct||0) - (a.match_pct||0);
            if (col === 'candidate') return a.candidate.localeCompare(b.candidate);
            if (col === 'required') return ( (b.required_skills||[]).length - (a.required_skills||[]).length );
            if (col === 'matched') return ( (b.matched_skills||[]).length - (a.matched_skills||[]).length );
            return 0;
          });
          renderRows(rows);
        };
      });

      // export CSV
      document.getElementById('exportCsvBtn').onclick = () => {
        const rows = (window._lastBatch && window._lastBatch.parsed) ? window._lastBatch.parsed : [];
        const csv = ['Candidate,Required Skills,Matched Skills,Match %,Selected'];
        rows.forEach(r => {
          const line = `"${r.candidate}","${(r.required_skills||[]).join('; ')}","${(r.matched_skills||[]).join('; ')}",${r.match_pct||0},${r.selected? 'TRUE':'FALSE'}`;
          csv.push(line);
        });
        const blob = new Blob([csv.join('\n')], {type:'text/csv'});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'batch_matches.csv';
        a.click();
      };

      document.getElementById('comparisonView').style.display = 'block';
      document.getElementById('comparisonView').scrollIntoView({behavior:'smooth'});
    }

    function renderSimBar(score, cls, pct) {
      const color = score >= 0.75 ? '#10B981' : (score >= 0.5 ? '#3B82F6' : '#9CA3AF');
      const width = Math.round(Math.max(0, Math.min(1, score)) * 100);
      return `<div style="display:flex; align-items:center; gap:8px;"><svg width="120" height="12" style="background:#eef2ff; border-radius:6px; overflow:visible;" role="img" aria-label="Similarity ${pct}%"><rect x="0" y="1" width="120" height="10" rx="6" fill="#eef2ff"></rect><rect x="0" y="1" width="${width * 1.2}" height="10" rx="6" fill="${color}"></rect></svg><span style="min-width:36px; color:#374151; font-weight:600;">${pct}%</span></div>`;
    }

    function displayResult(data) {
      // populate the result preview areas: left JSON panel and right quick table
      const jsonString = JSON.stringify(data, null, 2);
      try { document.getElementById('jsonExample').textContent = jsonString; } catch (e) { /* ignore */ }

      // Build quick single-row table using HR skills from the canonical input if provided
      try {
        const requiredRaw = (hrSkillsInput && hrSkillsInput.value && hrSkillsInput.value.trim()) ? hrSkillsInput.value.trim() : '';
        let required = [];
        if (requiredRaw) {
          required = requiredRaw.split(',').map(s => s.trim()).filter(Boolean);
        } else if (data.skills && Array.isArray(data.skills) && data.skills.length) {
          // fallback: use top 3 extracted skills
          required = data.skills.slice(0, 3);
        }

        const resumeSkills = (data.skills && Array.isArray(data.skills)) ? data.skills.map(s => String(s).toLowerCase()) : [];
        const reqLower = required.map(r => String(r).toLowerCase());
        const matched = reqLower.filter(r => resumeSkills.includes(r));
        const pct = required.length ? (matched.length / required.length * 100) : 0;
        const selected = pct >= 80;

        const pctBar = `<svg width="120" height="12" style="background:#eef2ff; border-radius:6px; overflow:visible; vertical-align:middle;"><rect x="0" y="1" width="120" height="10" rx="6" fill="#eef2ff"></rect><rect x="0" y="1" width="${Math.round(Math.max(0,Math.min(1,pct/100))*120)}" height="10" rx="6" fill="${pct>=80? '#10B981': (pct>=50? '#3B82F6':'#9CA3AF')}"></rect></svg>`;

        const tr = document.createElement('tr');
        if (selected) tr.className = 'match-high';
        tr.innerHTML = `
          <td>${data.candidate || (window._selectedFiles && window._selectedFiles[0] && window._selectedFiles[0].name) || 'Resume'}</td>
          <td>${(required || []).join(', ')}</td>
          <td>${(matched || []).join(', ')}</td>
          <td>${pctBar} <span style="margin-left:8px; font-weight:600;">${pct.toFixed(1)}%</span></td>
          <td style="text-align:center;"><input type="checkbox" ${selected ? 'checked' : ''} disabled></td>
        `;
        const tbody = document.getElementById('single-tbody');
        if (tbody) {
          tbody.innerHTML = '';
          tbody.appendChild(tr);
          const tbl = document.getElementById('single-table'); if (tbl) tbl.style.display = 'table';
        }

        // hide batch comparison view when showing single split
        const comp = document.getElementById('comparisonView'); if (comp) comp.style.display = 'none';
        // scroll See It in Action into view
        const see = document.querySelector('.example'); if (see) see.scrollIntoView({behavior:'smooth'});
      } catch (e) {
        console.error('Render single table failed', e);
      }

      // visual delight: confetti + mockup glow
      try { confettiBurst(); document.querySelector('.resume-mockup-svg')?.classList.add('glow'); setTimeout(()=>document.querySelector('.resume-mockup-svg')?.classList.remove('glow'), 1800); } catch(e){/*fail silently*/}
    }

    function copyResult() {
      const preElement = document.querySelector('#result pre');
      if (!preElement) return;
      navigator.clipboard.writeText(preElement.textContent)
        .then(() => alert('JSON copied to clipboard!'))
        .catch(err => {
          console.error('Copy failed:', err);
          alert('Failed to copy. Please manually select and copy the text.');
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
      // staged hero entrance
      const stagger = document.querySelector('.hero .stagger');
      if (stagger) setTimeout(() => stagger.classList.add('show'), 180);

      // add ripple handler to buttons
      document.querySelectorAll('.btn').forEach(btn => {
        btn.addEventListener('click', function (e) {
          const rect = this.getBoundingClientRect();
          const ripple = document.createElement('span');
          ripple.className = 'ripple';
          const size = Math.max(rect.width, rect.height) * 0.6;
          ripple.style.width = ripple.style.height = size + 'px';
          ripple.style.left = (e.clientX - rect.left - size/2) + 'px';
          ripple.style.top = (e.clientY - rect.top - size/2) + 'px';
          this.appendChild(ripple);
          setTimeout(() => ripple.remove(), 700);
        }, { passive: true });
      });

      // small test for image/svg availability (logs)
      const svg = document.querySelector('.resume-mockup-svg');
      if (svg) console.info('Hero mockup SVG present');
    });
  </script>

  <!-- ---------- NEW: Enhanced particle engine + confetti ---------- -->
  <script>
  (function () {
    // disable heavy effects on touch devices
    if ('ontouchstart' in window || navigator.maxTouchPoints > 0) return;

    const canvas = document.getElementById('particle-canvas');
    const ctx = canvas.getContext('2d', { alpha: true });
    let w = 0, h = 0, dpr = Math.max(1, window.devicePixelRatio || 1);
    function resize() {
      dpr = Math.max(1, window.devicePixelRatio || 1);
      w = window.innerWidth; h = window.innerHeight;
      canvas.width = Math.round(w * dpr); canvas.height = Math.round(h * dpr);
      canvas.style.width = w + 'px'; canvas.style.height = h + 'px';
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    window.addEventListener('resize', resize, { passive: true });
    resize();

    const MAX_PARTICLES = 120;
    const PALETTE = [{h:200,s:90,l:55},{h:170,s:90,l:45},{h:210,s:80,l:55}]; // blue/teal tones
    const particles = [];

    class Particle {
      constructor(x,y,vx,vy,size,life,hue) {
        this.x=x; this.y=y; this.vx=vx; this.vy=vy; this.size=size; this.life=life; this.age=0; this.hue=hue; this.alpha=1;
      }
      update(dt) {
        this.age += dt;
        this.vy += 10 * dt * 0.05; // tiny gravity
        this.x += this.vx * dt; this.y += this.vy * dt;
        this.vx *= 0.995; this.vy *= 0.995;
        const rem = Math.max(0, this.life - this.age);
        this.alpha = Math.pow(rem/this.life, 1.1);
        return this.age < this.life && this.y < h + 50;
      }
      draw(ctx) {
        ctx.beginPath();
        ctx.fillStyle = `hsla(${this.hue}, 90%, 55%, ${this.alpha})`;
        ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
        ctx.fill();
      }
    }

    function spawn(x,y,vx,vy,count){
      for(let i=0;i<count;i++){
        if(particles.length>=MAX_PARTICLES) break;
        const angle = (Math.random()-0.5)*Math.PI;
        const speed = 20 + Math.random()*40;
        const px = x + (Math.random()-0.5)*8;
        const py = y + (Math.random()-0.5)*8;
        const pvx = vx*0.5 + Math.cos(angle)*speed;
        const pvy = vy*0.5 + Math.sin(angle)*speed * -0.2 + (Math.random()-0.5)*8;
        const size = 1.5 + Math.random()*3.0;
        const life = 1.2 + Math.random()*1.6;
        const hueObj = PALETTE[Math.floor(Math.random()*PALETTE.length)];
        particles.push(new Particle(px,py,pvx,pvy,size,life,hueObj.h));
      }
    }

    let lastPos=null;
    document.addEventListener('mousemove', (ev) => {
      const now = performance.now();
      const x = ev.clientX, y = ev.clientY;
      if (!lastPos) lastPos = {x,y,t:now};
      const dt = Math.max(1, now - lastPos.t)/1000;
      const dx = x - lastPos.x, dy = y - lastPos.y;
      const dist = Math.sqrt(dx*dx + dy*dy);
      const speed = dist / Math.max(dt,0.001);
      const extra = Math.min(6, Math.floor(speed/220));
      spawn(x, y, dx/Math.max(dt,0.001), dy/Math.max(dt,0.001), 3 + extra);

      // parallax mockup shift
      const mock = document.querySelector('.resume-mockup-svg');
      if (mock) mock.style.transform = `translate(${(x - window.innerWidth/2)*0.004}px, ${(y - window.innerHeight/2)*0.003}px)`;
      lastPos = {x,y,t:now};
    }, { passive: true });

    // gentle restore of mockup transform
    setInterval(()=> {
      const mock = document.querySelector('.resume-mockup-svg');
      if (mock) mock.style.transform = '';
    }, 1200);

    let lastFrame = performance.now();
    function frame(now) {
      const dt = Math.min(0.05, (now - lastFrame)/1000);
      lastFrame = now;
      ctx.clearRect(0,0,w,h);

      for(let i=particles.length-1;i>=0;i--){
        if(!particles[i].update(dt)) particles.splice(i,1);
      }
      for(let i=0;i<particles.length;i++) particles[i].draw(ctx);
      requestAnimationFrame(frame);
    }
    requestAnimationFrame(frame);

    document.addEventListener('visibilitychange', ()=> { if(document.hidden) particles.length=0; });

    // lightweight confetti burst (called on success)
    window.confettiBurst = function(count=60){
      const cx = window.innerWidth/2, cy = window.innerHeight/3;
      for(let i=0;i<count;i++){
        const angle = Math.random()*Math.PI*2;
        const speed = 80 + Math.random()*160;
        const vx = Math.cos(angle)*speed, vy = Math.sin(angle)*speed;
        const size = 2 + Math.random()*4;
        const life = 1 + Math.random()*1.6;
        const hue = [200,170,210,150][Math.floor(Math.random()*4)];
        particles.push(new Particle(cx,cy,vx,vy,size,life,hue));
      }
    };
  })();
  </script>
</body>
</html>
